@page "/ScheduleUser"
@inject IScheduleUserService scheduleUserService
<h3>Cadastro Agenda do Usuário</h3>
<button data-bs-toggle="modal" data-bs-target="#newScheduleUser" class="btn btn-info">
    Nova Agenda
</button>
@if (scheduleUserView is null)
{
    <div class="spinner-border" role="status">
        <span class="visually-hidden">Loading...</span>
    </div>
}
else
{
    if (messagem is not null)
    {
        <MensageError Message="@messagem" />
    }

    <TableScheduleUser ScheduleUserView="scheduleUserView" />

    <PaginationTable PageCurrent="@ReceberPagina"
                     TotalData="@scheduleUserView.TotalData"
                     Page="@scheduleUserView.Page"
                     TotalPage="@scheduleUserView.TotalPage" />

    <InsertScheduleUserModal ErroRetornado="ReceiveError" DataUpdated="@(() => DataUpdated())" />
}

@code {
    private ScheduleUserView? scheduleUserView;
    private string? messagem { get; set; };

    protected override async Task OnInitializedAsync()
    {
        scheduleUserView = await scheduleUserService.GetAll();
    }
    private async void DataUpdated()
    {
        scheduleUserView = await scheduleUserService.GetAll();
        StateHasChanged();
    }
    private async Task ReceberPagina(int pageCurrent)
    {
        scheduleUserView = await scheduleUserService.GetAll(pageCurrent);
    }

    private async Task ReceiveError(string message)
    {
        messagem = message;
    }
}
