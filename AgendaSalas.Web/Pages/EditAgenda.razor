@page "/EditAgenda/{Id:int}"
@inject IAgendaService agendaService
@inject ISalaService salaService
@inject NavigationManager NavigationManager
<h3>Editar Agenda</h3>

<EditForm Model="@agendaDto" OnSubmit="@Edit">

    <InputSelect @bind-Value="agendaDto!.SalaId">
        @if (salaView?.SalasDto is not null)
        {
            <option value="0">Selecione uma Opção</option>
            @foreach (var sala in salaView.SalasDto)
            {
                <option value="@sala.Id"> @sala.Nome</option>
            }
        }
    </InputSelect>

    <InputText @bind-Value="agendaDto!.Descricao" placeholder="Descrição" />
    <InputDate Type="InputDateType.DateTimeLocal" @bind-Value="agendaDto.DataInicio" />
    <InputDate Type="InputDateType.DateTimeLocal" @bind-Value="agendaDto.DataFinal" />
    <InputCheckbox @bind-Value="agendaDto.PermitirLigar" /> Ligar
    <InputCheckbox @bind-Value="agendaDto.PermitirChamar" /> Chamar

    <button type="submit">Salvar</button>
</EditForm>

@code {
    [Parameter]
    public int Id { get; set; }

    private AgendaDto? agendaDto { get; set; } = new();
    private SalaView? salaView { get; set; } = new();

    protected override async Task OnInitializedAsync()
    {
        salaView = await salaService.GetAll();
        agendaDto = await agendaService.GetById(Id);
       

    }

    private async Task Edit()
    {
        await agendaService.Update(agendaDto!);
        NavigationManager.NavigateTo("/Agenda");

    }
}
